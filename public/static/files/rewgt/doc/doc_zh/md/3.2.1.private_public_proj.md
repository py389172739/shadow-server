3.2.1 私有工程与公有工程
---------------------

&nbsp;

#### shadow-server 的目录结构

shadow-server 是 Shadow Widget 开发系统在本机提供的 WebService 服务，前面介绍的众多样例工程，通过类似 `http://localhost:3000/demo1/` 形式访问的，都是 shadow-server 软件提供的 Web 服务。在基础篇 [简单示例](#1.4.) 中，我们介绍了 shadow-server 如何安装方式，安装后目录结构如下（已略去一些无关目录）：

```
  user
  +-- shadow-server
  |   +-- public
  |   |   +-- static
  |   |   |   +-- demo1
  |   |   |   +-- demo2
  +-- shadow-widget
  |   +-- bundle.js
  +-- public-project
```

其中 `user` 目录是公有工程目录，`user/shadow-server/public/static` 是私有工程目录。如上图，demo1 与 demo2 是私有工程，shadow-server、shadow-widget、public-project 是公有工程。

#### 为什么要区分公有工程与私有工程？

私有工程是只有自己才关心的，公有工程则是来自他人共享，或自己要共享出去的。凡涉及多人资源共享，必会遭遇重名问题， user 目录可理解为我们对世上所有工程取一个映射子集，这个集合已有重名问题，但如果将它与特定网站（如 github）所管理的项目对应起来，重名问题是可以解决的。

但在本机做开发，自行创建的工程命名可能很随意，我们希望随意命名的工程，不要与已受管理的公有工程掺和一起，所以分开在两个目录，分别管理公有与私有工程。

当私有工程命名与某个公有工程相同时，用 URL 访问得到的是私有工程，这种处理方式与常规编程中当局部变量与全局变量重名时以局部变量为准类似。

#### <a name="cate"></a>分类目录

采用上述公有与私有工程的方式管理软件开发项目，基本够用，但如果我们将文档（尤其是网页形式的文档）也纳入管理，为避免命名冲突，每次新写一篇文档如何命名会很费劲，因为文档数目可能是海量的，某些人每天都会制造数篇文档，长年累月下来，这种在单一层级区分命名的方式显然不够用了。

引入 “分类目录” 机制可解决这个问题，比如：

```
  user
  +-- $$doc
  |   +-- $$plan
  |   |   +-- plan_of_feb
  |   |   +-- plan_of_aug
  |   +-- $$design
  |   |   +-- module_a_design
  |   |   +-- module_b_design
```

前缀 `$$` 表示它是 “分类目录”，多个连续的分类目录可以串起来，如上面 `$$doc/$$plan`，分类目录下非 `$$` 前缀命名的，才是工程目录，比如上面定义了 4 个工程目录。

公有工程目录与私有工程目录下均可使用分类目录，分类目录可以有 1 级，或任意 N 级。

#### 把 user 目录名改成自己的用户名

理解为 `user` 目录的功能后，不妨将该目录名改成为您在 github 注册的账户名，比如，shadow-widget 注册的账户是 rewgt，`github.com/rewgt/shadow-server` 与 `github.com/rewgt/shadow-widget` 都是该帐户下的工程。这么处理后，本机目录结构与 github 上的目录就统一起来了。提醒一句，改名只是为了方便理解、记忆，不影响 Shadow Widget 任何功能。

将多个工程放一起管理，方便了它们之间以 URI 方式直接引用。比如文件 `/shadow-widget/bundle.js` 已将 react、react-dom、shadow-widget 的 JS 库打包在一起，在任意工程的 html 文件中按如下方式引用，可以快速建立一个 Shadow Widget 编程环境。

```
  <script src="/shadow-widget/bundle.js"></script>
``` 

上述工程命名及目录组织方式，也很好契合了 <a target="_blank" href="https://www.pinp.me/">pinp 社区</a> 的要求，本机 Web 服务与线上服务可以无缝迁移。在本机调试的 Shadow Widget 程序，发布到 pinp 网盘后可以直接打开来用，奥秘在哪儿？在前面众多例子中，我们引用 `/files/rewgt/css/base.css` 文件，却写成 `/app/files/rewgt/web/css/base.css`，额外插入 `'app'` 与 `'web'` 两段就是为了兼容，本机的 WebService 支持这种兼容的 URL 表达方式。

&nbsp;
